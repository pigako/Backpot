{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect, useCallback, useRef, useState } from 'react';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport moment from 'moment';\nimport Helmet from 'react-helmet';\nimport { useRouter } from 'next/router';\nimport Button from '../components/designs/Button';\nimport { LOAD_BOARD_REQUEST, DELETE_BOARD_REQUEST, UPDATE_BOARD_REQUEST, ADD_COMMENT_REQUEST } from '../reducers/board';\nimport CommentCard from '../components/CommentCard';\nconst SBoard = styled.div.withConfig({\n  displayName: \"detailboard__SBoard\",\n  componentId: \"sc-18cmj5i-0\"\n})([\"width:98%;margin-top:10px;\"]);\nconst SDetailBoardTitle = styled.h1.withConfig({\n  displayName: \"detailboard__SDetailBoardTitle\",\n  componentId: \"sc-18cmj5i-1\"\n})([\"display:inline-block;font-weight:bold;margin-left:10px;width:100%;\"]);\nconst SBoardTop = styled.div.withConfig({\n  displayName: \"detailboard__SBoardTop\",\n  componentId: \"sc-18cmj5i-2\"\n})([\"margin-top:1rem;padding-bottom:1rem;border-bottom:solid 2px #6441a5;\"]);\nconst SBoardTitle = styled.div.withConfig({\n  displayName: \"detailboard__SBoardTitle\",\n  componentId: \"sc-18cmj5i-3\"\n})([\"display:inline-block;\"]);\nconst SBoardTitleLabel = styled.label.withConfig({\n  displayName: \"detailboard__SBoardTitleLabel\",\n  componentId: \"sc-18cmj5i-4\"\n})([\"display:block;font-size:1.5rem;margin-bottom:1rem;\"]);\nconst SBoardWriterLabel = styled.label.withConfig({\n  displayName: \"detailboard__SBoardWriterLabel\",\n  componentId: \"sc-18cmj5i-5\"\n})([\"padding-right:1rem;border-right:solid 1px #495057;& > strong{font-weight:bold;}\"]);\nconst SBoardCreateLabel = styled.label.withConfig({\n  displayName: \"detailboard__SBoardCreateLabel\",\n  componentId: \"sc-18cmj5i-6\"\n})([\"padding-left:1rem;\"]);\nconst SBoardTitleButtonDiv = styled.div.withConfig({\n  displayName: \"detailboard__SBoardTitleButtonDiv\",\n  componentId: \"sc-18cmj5i-7\"\n})([\"float:right;\"]);\nconst SBoardContent = styled.div.withConfig({\n  displayName: \"detailboard__SBoardContent\",\n  componentId: \"sc-18cmj5i-8\"\n})([\"margin:1.5rem;& > div{font-size:1rem;line-height:1.5rem;}\"]);\nconst SBoardComment = styled.div.withConfig({\n  displayName: \"detailboard__SBoardComment\",\n  componentId: \"sc-18cmj5i-9\"\n})([\"border-top:solid 3px #6441a5;\"]);\nconst SBoardCommentCountDiv = styled.div.withConfig({\n  displayName: \"detailboard__SBoardCommentCountDiv\",\n  componentId: \"sc-18cmj5i-10\"\n})([\"height:2rem;background:#e7e7e7;display:flex;align-items:center;border-bottom:solid 3px #6441a5;& > label{font-size:1rem;font-weight:bold;margin-left:1rem;}\"]);\nconst CommentDiv = styled.div.withConfig({\n  displayName: \"detailboard__CommentDiv\",\n  componentId: \"sc-18cmj5i-11\"\n})([\"height:330px;\"]);\nconst CommentButton = styled(Button).withConfig({\n  displayName: \"detailboard__CommentButton\",\n  componentId: \"sc-18cmj5i-12\"\n})([\"width:8rem;margin-right:1.5rem;float:right;\"]);\nconst LoadingImg = styled.img.withConfig({\n  displayName: \"detailboard__LoadingImg\",\n  componentId: \"sc-18cmj5i-13\"\n})([\"margin-top:4px;height:1.5rem;\"]);\n\nconst DetailBoard = () => {\n  const {\n    boardDeleted,\n    board,\n    isUpdatingBoard,\n    isAddingComment,\n    commentAdded\n  } = useSelector(state => state.board);\n  const {\n    id: myId\n  } = useSelector(state => state.user.me) || false;\n  const dispatch = useDispatch();\n  const router = useRouter();\n  const editorRef = useRef();\n  const {\n    CKEditor,\n    ClassicEditor\n  } = editorRef.current || {};\n  const {\n    0: editorLoded,\n    1: setEditorLoded\n  } = useState(false);\n  const {\n    0: userComment,\n    1: setUserComment\n  } = useState('');\n  const {\n    0: updateText,\n    1: setUpdateText\n  } = useState('');\n  const {\n    0: isUpdating,\n    1: setIsUpdating\n  } = useState(false);\n  useEffect(() => {\n    editorRef.current = {\n      CKEditor: require('@ckeditor/ckeditor5-react'),\n      ClassicEditor: require('@ckeditor/ckeditor5-build-classic')\n    };\n    setEditorLoded(true);\n  }, []);\n  useEffect(() => {\n    if (boardDeleted) {\n      router.push('/board');\n    }\n  }, [boardDeleted]);\n  useEffect(() => {\n    if (commentAdded) {\n      setUserComment('');\n    }\n  }, [commentAdded]);\n  const onUpdateBoard = useCallback(e => {\n    if (isUpdating) {\n      dispatch({\n        type: UPDATE_BOARD_REQUEST,\n        data: {\n          id: board.id,\n          content: updateText\n        }\n      });\n      setIsUpdating(false);\n    } else {\n      setIsUpdating(true);\n    }\n  }, [isUpdating, board && board.id, updateText]);\n  const onUpdateBoardCancle = useCallback(e => {\n    setIsUpdating(false);\n    setUpdateText(board && board.content);\n  }, [isUpdating]);\n  const onDeleteBoard = useCallback(e => {\n    dispatch({\n      type: DELETE_BOARD_REQUEST,\n      boardId: board.id\n    });\n  }, [board && board.id]);\n  const onCreateComment = useCallback(e => {\n    if (!userComment.trim()) {\n      return;\n    }\n\n    dispatch({\n      type: ADD_COMMENT_REQUEST,\n      data: {\n        boardId: board.id,\n        content: userComment\n      }\n    });\n  }, [board && board.id, userComment]);\n  return __jsx(SBoard, null, __jsx(Helmet, null, __jsx(\"title\", null, board && board.title), __jsx(\"style\", {\n    type: \"text/css\"\n  }, `\n            .ck-editor__editable { height: 200px;}\n            .ck.ck-reset.ck-editor.ck-rounded-corners {margin: 1.5rem;}\n          `)), __jsx(SDetailBoardTitle, null, \"\\uCD94\\uCC9C\\uAC8C\\uC2DC\\uAE00\"), __jsx(SBoardTop, null, __jsx(SBoardTitle, null, __jsx(SBoardTitleLabel, null, board && board.title), __jsx(SBoardWriterLabel, null, __jsx(\"strong\", null, board && board.User.nickname), \" \\uB2D8\"), __jsx(SBoardCreateLabel, null, moment(board && board.createdAt).format('YY.MM.DD HH시 mm분'))), myId === (board && board.User.id) ? __jsx(SBoardTitleButtonDiv, null, isUpdating ? __jsx(Button, {\n    onClick: onUpdateBoardCancle\n  }, \"\\uCDE8\\uC18C\") : null, __jsx(Button, {\n    onClick: onUpdateBoard\n  }, isUpdatingBoard ? __jsx(LoadingImg, {\n    src: \"/static/icons/loading_blue.gif\"\n  }) : `수정`), __jsx(Button, {\n    color: 'pink',\n    onClick: onDeleteBoard\n  }, \"\\uC0AD\\uC81C\")) : null), __jsx(SBoardContent, null, isUpdating ? editorLoded ? __jsx(CKEditor, {\n    key: 'board',\n    editor: ClassicEditor,\n    data: board && board.content,\n    onChange: (event, editor) => {\n      const data = editor.getData();\n      setUpdateText(data);\n    }\n  }) : __jsx(\"p\", null, \"Editor Loding\") : __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: board && board.content\n    }\n  })), __jsx(SBoardComment, null, __jsx(SBoardCommentCountDiv, null, __jsx(\"label\", null, \"\\uB313\\uAE00 \", board && board.Comments.length, \"\\uAC1C\")), board && board.Comments.map(comment => {\n    return __jsx(CommentCard, {\n      key: +comment.id,\n      comment: comment\n    });\n  })), myId && __jsx(CommentDiv, null, editorLoded ? __jsx(CKEditor, {\n    key: 'comment',\n    editor: ClassicEditor,\n    data: userComment,\n    onChange: (event, editor) => {\n      const data = editor.getData();\n      setUserComment(data);\n    }\n  }) : __jsx(\"p\", null, \"Editor Loding\"), __jsx(CommentButton, {\n    onClick: onCreateComment\n  }, isAddingComment ? __jsx(LoadingImg, {\n    src: \"/static/icons/loading_blue.gif\"\n  }) : `댓글쓰기`)));\n};\n\nDetailBoard.getInitialProps = context => {\n  const id = parseInt(context.query.id, 10);\n  context.store.dispatch({\n    type: LOAD_BOARD_REQUEST,\n    boardId: id\n  });\n};\n\nexport default DetailBoard;","map":{"version":3,"sources":["C:/Document/Backpot/front/pages/detailboard.js"],"names":["React","useEffect","useCallback","useRef","useState","styled","useSelector","useDispatch","moment","Helmet","useRouter","Button","LOAD_BOARD_REQUEST","DELETE_BOARD_REQUEST","UPDATE_BOARD_REQUEST","ADD_COMMENT_REQUEST","CommentCard","SBoard","div","SDetailBoardTitle","h1","SBoardTop","SBoardTitle","SBoardTitleLabel","label","SBoardWriterLabel","SBoardCreateLabel","SBoardTitleButtonDiv","SBoardContent","SBoardComment","SBoardCommentCountDiv","CommentDiv","CommentButton","LoadingImg","img","DetailBoard","boardDeleted","board","isUpdatingBoard","isAddingComment","commentAdded","state","id","myId","user","me","dispatch","router","editorRef","CKEditor","ClassicEditor","current","editorLoded","setEditorLoded","userComment","setUserComment","updateText","setUpdateText","isUpdating","setIsUpdating","require","push","onUpdateBoard","e","type","data","content","onUpdateBoardCancle","onDeleteBoard","boardId","onCreateComment","trim","title","User","nickname","createdAt","format","event","editor","getData","__html","Comments","length","map","comment","getInitialProps","context","parseInt","query","store"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useRef, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport moment from 'moment';\r\nimport Helmet from 'react-helmet';\r\nimport { useRouter } from 'next/router';\r\n\r\nimport Button from '../components/designs/Button';\r\nimport {\r\n  LOAD_BOARD_REQUEST,\r\n  DELETE_BOARD_REQUEST,\r\n  UPDATE_BOARD_REQUEST,\r\n  ADD_COMMENT_REQUEST,\r\n} from '../reducers/board';\r\nimport CommentCard from '../components/CommentCard';\r\n\r\nconst SBoard = styled.div`\r\n  width: 98%;\r\n  margin-top: 10px;\r\n`;\r\nconst SDetailBoardTitle = styled.h1`\r\n  display: inline-block;\r\n  font-weight: bold;\r\n  margin-left: 10px;\r\n  width: 100%;\r\n`;\r\nconst SBoardTop = styled.div`\r\n  margin-top: 1rem;\r\n  padding-bottom: 1rem;\r\n  border-bottom: solid 2px #6441a5;\r\n`;\r\nconst SBoardTitle = styled.div`\r\n  display: inline-block;\r\n`;\r\nconst SBoardTitleLabel = styled.label`\r\n  display: block;\r\n  font-size: 1.5rem;\r\n  margin-bottom: 1rem;\r\n`;\r\nconst SBoardWriterLabel = styled.label`\r\n  padding-right: 1rem;\r\n  border-right: solid 1px #495057;\r\n  & > strong {\r\n    font-weight: bold;\r\n  }\r\n`;\r\nconst SBoardCreateLabel = styled.label`\r\n  padding-left: 1rem;\r\n`;\r\nconst SBoardTitleButtonDiv = styled.div`\r\n  float: right;\r\n`;\r\nconst SBoardContent = styled.div`\r\n  margin: 1.5rem;\r\n\r\n  & > div {\r\n    font-size: 1rem;\r\n    line-height: 1.5rem;\r\n  }\r\n`;\r\nconst SBoardComment = styled.div`\r\n  border-top: solid 3px #6441a5;\r\n`;\r\nconst SBoardCommentCountDiv = styled.div`\r\n  height: 2rem;\r\n  background: #e7e7e7;\r\n  display: flex;\r\n  align-items: center;\r\n  border-bottom: solid 3px #6441a5;\r\n  & > label {\r\n    font-size: 1rem;\r\n    font-weight: bold;\r\n    margin-left: 1rem;\r\n  }\r\n`;\r\n\r\nconst CommentDiv = styled.div`\r\n  height: 330px;\r\n`;\r\n\r\nconst CommentButton = styled(Button)`\r\n  width: 8rem;\r\n  margin-right: 1.5rem;\r\n  float: right;\r\n`;\r\n\r\nconst LoadingImg = styled.img`\r\n  margin-top: 4px;\r\n  height: 1.5rem;\r\n`;\r\n\r\nconst DetailBoard = () => {\r\n  const {\r\n    boardDeleted,\r\n    board,\r\n    isUpdatingBoard,\r\n    isAddingComment,\r\n    commentAdded,\r\n  } = useSelector(state => state.board);\r\n  const { id: myId } = useSelector(state => state.user.me) || false;\r\n  const dispatch = useDispatch();\r\n  const router = useRouter();\r\n\r\n  const editorRef = useRef();\r\n  const { CKEditor, ClassicEditor } = editorRef.current || {};\r\n  const [editorLoded, setEditorLoded] = useState(false);\r\n\r\n  const [userComment, setUserComment] = useState('');\r\n  const [updateText, setUpdateText] = useState('');\r\n  const [isUpdating, setIsUpdating] = useState(false);\r\n\r\n  useEffect(() => {\r\n    editorRef.current = {\r\n      CKEditor: require('@ckeditor/ckeditor5-react'),\r\n      ClassicEditor: require('@ckeditor/ckeditor5-build-classic'),\r\n    };\r\n    setEditorLoded(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (boardDeleted) {\r\n      router.push('/board');\r\n    }\r\n  }, [boardDeleted]);\r\n\r\n  useEffect(() => {\r\n    if (commentAdded) {\r\n      setUserComment('');\r\n    }\r\n  }, [commentAdded]);\r\n\r\n  const onUpdateBoard = useCallback(\r\n    e => {\r\n      if (isUpdating) {\r\n        dispatch({\r\n          type: UPDATE_BOARD_REQUEST,\r\n          data: {\r\n            id: board.id,\r\n            content: updateText,\r\n          },\r\n        });\r\n        setIsUpdating(false);\r\n      } else {\r\n        setIsUpdating(true);\r\n      }\r\n    },\r\n    [isUpdating, board && board.id, updateText],\r\n  );\r\n\r\n  const onUpdateBoardCancle = useCallback(\r\n    e => {\r\n      setIsUpdating(false);\r\n      setUpdateText(board && board.content);\r\n    },\r\n    [isUpdating],\r\n  );\r\n\r\n  const onDeleteBoard = useCallback(\r\n    e => {\r\n      dispatch({\r\n        type: DELETE_BOARD_REQUEST,\r\n        boardId: board.id,\r\n      });\r\n    },\r\n    [board && board.id],\r\n  );\r\n\r\n  const onCreateComment = useCallback(\r\n    e => {\r\n      if (!userComment.trim()) {\r\n        return;\r\n      }\r\n      dispatch({\r\n        type: ADD_COMMENT_REQUEST,\r\n        data: {\r\n          boardId: board.id,\r\n          content: userComment,\r\n        },\r\n      });\r\n    },\r\n    [board && board.id, userComment],\r\n  );\r\n  return (\r\n    <SBoard>\r\n      <Helmet>\r\n        <title>{board && board.title}</title>\r\n        <style type=\"text/css\">\r\n          {`\r\n            .ck-editor__editable { height: 200px;}\r\n            .ck.ck-reset.ck-editor.ck-rounded-corners {margin: 1.5rem;}\r\n          `}\r\n        </style>\r\n      </Helmet>\r\n      <SDetailBoardTitle>추천게시글</SDetailBoardTitle>\r\n      <SBoardTop>\r\n        <SBoardTitle>\r\n          <SBoardTitleLabel>{board && board.title}</SBoardTitleLabel>\r\n          <SBoardWriterLabel>\r\n            <strong>{board && board.User.nickname}</strong> 님\r\n          </SBoardWriterLabel>\r\n          <SBoardCreateLabel>\r\n            {moment(board && board.createdAt).format('YY.MM.DD HH시 mm분')}\r\n          </SBoardCreateLabel>\r\n        </SBoardTitle>\r\n        {myId === (board && board.User.id) ? (\r\n          <SBoardTitleButtonDiv>\r\n            {isUpdating ? (\r\n              <Button onClick={onUpdateBoardCancle}>취소</Button>\r\n            ) : null}\r\n            <Button onClick={onUpdateBoard}>\r\n              {isUpdatingBoard ? (\r\n                <LoadingImg src=\"/static/icons/loading_blue.gif\" />\r\n              ) : (\r\n                `수정`\r\n              )}\r\n            </Button>\r\n            <Button color={'pink'} onClick={onDeleteBoard}>\r\n              삭제\r\n            </Button>\r\n          </SBoardTitleButtonDiv>\r\n        ) : null}\r\n      </SBoardTop>\r\n      <SBoardContent>\r\n        {isUpdating ? (\r\n          editorLoded ? (\r\n            <CKEditor\r\n              key={'board'}\r\n              editor={ClassicEditor}\r\n              data={board && board.content}\r\n              onChange={(event, editor) => {\r\n                const data = editor.getData();\r\n                setUpdateText(data);\r\n              }}\r\n            />\r\n          ) : (\r\n            <p>Editor Loding</p>\r\n          )\r\n        ) : (\r\n          <div dangerouslySetInnerHTML={{ __html: board && board.content }} />\r\n        )}\r\n      </SBoardContent>\r\n      <SBoardComment>\r\n        <SBoardCommentCountDiv>\r\n          <label>댓글 {board && board.Comments.length}개</label>\r\n        </SBoardCommentCountDiv>\r\n\r\n        {board &&\r\n          board.Comments.map(comment => {\r\n            return <CommentCard key={+comment.id} comment={comment} />;\r\n          })}\r\n      </SBoardComment>\r\n      {myId && (\r\n        <CommentDiv>\r\n          {editorLoded ? (\r\n            <CKEditor\r\n              key={'comment'}\r\n              editor={ClassicEditor}\r\n              data={userComment}\r\n              onChange={(event, editor) => {\r\n                const data = editor.getData();\r\n                setUserComment(data);\r\n              }}\r\n            />\r\n          ) : (\r\n            <p>Editor Loding</p>\r\n          )}\r\n          <CommentButton onClick={onCreateComment}>\r\n            {isAddingComment ? (\r\n              <LoadingImg src=\"/static/icons/loading_blue.gif\" />\r\n            ) : (\r\n              `댓글쓰기`\r\n            )}\r\n          </CommentButton>\r\n        </CommentDiv>\r\n      )}\r\n    </SBoard>\r\n  );\r\n};\r\n\r\nDetailBoard.getInitialProps = context => {\r\n  const id = parseInt(context.query.id, 10);\r\n  context.store.dispatch({\r\n    type: LOAD_BOARD_REQUEST,\r\n    boardId: id,\r\n  });\r\n};\r\n\r\nexport default DetailBoard;\r\n"]},"metadata":{},"sourceType":"module"}