{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchLoadBooks),\n    _marked2 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchLoadBook),\n    _marked3 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchAddLikebook),\n    _marked4 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchRemoveLikebook),\n    _marked5 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchUploadImage),\n    _marked6 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchAddBook),\n    _marked7 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchLoadGenre),\n    _marked8 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(watchUpdateBook),\n    _marked9 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(bookSaga);\n\nimport { all, call, fork, throttle, takeLatest, put } from 'redux-saga/effects';\nimport axios from 'axios';\nimport { LOAD_BOOKS_REQUEST, LOAD_BOOKS_SUCCESS, LOAD_BOOKS_FAILURE, LOAD_BOOK_REQUEST, LOAD_BOOK_SUCCESS, LOAD_BOOK_FAILURE, ADD_LIKEBOOK_REQUEST, ADD_LIKEBOOK_SUCCESS, ADD_LIKEBOOK_FAILURE, REMOVE_LIKEBOOK_REQUEST, REMOVE_LIKEBOOK_SUCCESS, REMOVE_LIKEBOOK_FAILURE, UPLOAD_IMAGE_REQUEST, UPLOAD_IMAGE_SUCCESS, UPLOAD_IMAGE_FAILURE, ADD_BOOK_REQUEST, ADD_BOOK_FAILURE, ADD_BOOK_SUCCESS, LOAD_GENRE_REQUEST, LOAD_GENRE_SUCCESS, LOAD_GENRE_FAILURE, UPDATE_BOOK_REQUEST, UPDATE_BOOK_SUCCESS, UPDATE_BOOK_FAILURE } from '../reducers/book';\nimport { ADD_LIKEBOOKLIST, REMOVE_LIKEBOOKLIST } from '../reducers/user'; // 전체 연재글 가져오기\n\nfunction watchLoadBooks() {\n  return _regeneratorRuntime.wrap(function watchLoadBooks$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return throttle(1000, LOAD_BOOKS_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function loadBooks(action) {\n            var result;\n            return _regeneratorRuntime.wrap(function loadBooks$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.prev = 0;\n                    _context.next = 3;\n                    return call(function () {\n                      var lastId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n                      var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 20;\n                      return axios.get(\"/books?lastId=\".concat(lastId, \"&limit=\").concat(limit));\n                    }, action.lastId);\n\n                  case 3:\n                    result = _context.sent;\n                    _context.next = 6;\n                    return put({\n                      type: LOAD_BOOKS_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context.next = 13;\n                    break;\n\n                  case 8:\n                    _context.prev = 8;\n                    _context.t0 = _context[\"catch\"](0);\n                    console.log(_context.t0);\n                    _context.next = 13;\n                    return put({\n                      type: LOAD_BOOKS_FAILURE,\n                      error: _context.t0\n                    });\n\n                  case 13:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, loadBooks, null, [[0, 8]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked);\n} // 게시글 하나 조회\n\n\nfunction watchLoadBook() {\n  return _regeneratorRuntime.wrap(function watchLoadBook$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return takeLatest(LOAD_BOOK_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function loadBook(action) {\n            var result;\n            return _regeneratorRuntime.wrap(function loadBook$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    _context3.prev = 0;\n                    _context3.next = 3;\n                    return call(function (bookId) {\n                      return axios.get(\"/book/\".concat(bookId));\n                    }, action.id);\n\n                  case 3:\n                    result = _context3.sent;\n                    _context3.next = 6;\n                    return put({\n                      type: LOAD_BOOK_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context3.next = 12;\n                    break;\n\n                  case 8:\n                    _context3.prev = 8;\n                    _context3.t0 = _context3[\"catch\"](0);\n                    console.log(_context3.t0);\n                    put({\n                      type: LOAD_BOOK_FAILURE,\n                      error: _context3.t0\n                    });\n\n                  case 12:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, loadBook, null, [[0, 8]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked2);\n} // 선호작 추가\n\n\nfunction watchAddLikebook() {\n  return _regeneratorRuntime.wrap(function watchAddLikebook$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.next = 2;\n          return takeLatest(ADD_LIKEBOOK_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function addLikebook(action) {\n            var result;\n            return _regeneratorRuntime.wrap(function addLikebook$(_context5) {\n              while (1) {\n                switch (_context5.prev = _context5.next) {\n                  case 0:\n                    _context5.prev = 0;\n                    _context5.next = 3;\n                    return call(function (bookId) {\n                      return axios.post(\"/book/\".concat(bookId, \"/like\"), {}, {\n                        withCredentials: true\n                      });\n                    }, action.bookId);\n\n                  case 3:\n                    result = _context5.sent;\n                    _context5.next = 6;\n                    return put({\n                      type: ADD_LIKEBOOK_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context5.next = 8;\n                    return put({\n                      type: ADD_LIKEBOOKLIST,\n                      data: _objectSpread({\n                        id: result.data\n                      }, action.data)\n                    });\n\n                  case 8:\n                    _context5.next = 15;\n                    break;\n\n                  case 10:\n                    _context5.prev = 10;\n                    _context5.t0 = _context5[\"catch\"](0);\n                    console.log(_context5.t0);\n                    _context5.next = 15;\n                    return put({\n                      type: ADD_LIKEBOOK_FAILURE,\n                      error: _context5.t0\n                    });\n\n                  case 15:\n                  case \"end\":\n                    return _context5.stop();\n                }\n              }\n            }, addLikebook, null, [[0, 10]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, _marked3);\n} // 선호작 해제\n\n\nfunction watchRemoveLikebook() {\n  return _regeneratorRuntime.wrap(function watchRemoveLikebook$(_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          _context8.next = 2;\n          return takeLatest(REMOVE_LIKEBOOK_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function removeLikebook(action) {\n            var result;\n            return _regeneratorRuntime.wrap(function removeLikebook$(_context7) {\n              while (1) {\n                switch (_context7.prev = _context7.next) {\n                  case 0:\n                    _context7.prev = 0;\n                    _context7.next = 3;\n                    return call(function (bookId) {\n                      return axios[\"delete\"](\"/book/\".concat(bookId, \"/unlike\"), {\n                        withCredentials: true\n                      });\n                    }, action.bookId);\n\n                  case 3:\n                    result = _context7.sent;\n                    _context7.next = 6;\n                    return put({\n                      type: REMOVE_LIKEBOOK_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context7.next = 8;\n                    return put({\n                      type: REMOVE_LIKEBOOKLIST,\n                      data: result.data\n                    });\n\n                  case 8:\n                    _context7.next = 14;\n                    break;\n\n                  case 10:\n                    _context7.prev = 10;\n                    _context7.t0 = _context7[\"catch\"](0);\n                    console.log(_context7.t0);\n                    put({\n                      type: REMOVE_LIKEBOOK_FAILURE,\n                      error: _context7.t0\n                    });\n\n                  case 14:\n                  case \"end\":\n                    return _context7.stop();\n                }\n              }\n            }, removeLikebook, null, [[0, 10]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  }, _marked4);\n} // 썸네일 이미지 업로드\n\n\nfunction watchUploadImage() {\n  return _regeneratorRuntime.wrap(function watchUploadImage$(_context10) {\n    while (1) {\n      switch (_context10.prev = _context10.next) {\n        case 0:\n          _context10.next = 2;\n          return takeLatest(UPLOAD_IMAGE_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function uploadImage(action) {\n            var result;\n            return _regeneratorRuntime.wrap(function uploadImage$(_context9) {\n              while (1) {\n                switch (_context9.prev = _context9.next) {\n                  case 0:\n                    _context9.prev = 0;\n                    _context9.next = 3;\n                    return call(function (formData) {\n                      return axios.post('/book/thumbnail', formData, {\n                        withCredentials: true\n                      });\n                    }, action.data);\n\n                  case 3:\n                    result = _context9.sent;\n                    _context9.next = 6;\n                    return put({\n                      type: UPLOAD_IMAGE_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context9.next = 13;\n                    break;\n\n                  case 8:\n                    _context9.prev = 8;\n                    _context9.t0 = _context9[\"catch\"](0);\n                    console.log(_context9.t0);\n                    _context9.next = 13;\n                    return put({\n                      type: UPLOAD_IMAGE_FAILURE,\n                      error: _context9.t0\n                    });\n\n                  case 13:\n                  case \"end\":\n                    return _context9.stop();\n                }\n              }\n            }, uploadImage, null, [[0, 8]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context10.stop();\n      }\n    }\n  }, _marked5);\n} // 작품 만들기\n\n\nfunction watchAddBook() {\n  return _regeneratorRuntime.wrap(function watchAddBook$(_context12) {\n    while (1) {\n      switch (_context12.prev = _context12.next) {\n        case 0:\n          _context12.next = 2;\n          return takeLatest(ADD_BOOK_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function addBook(action) {\n            var result;\n            return _regeneratorRuntime.wrap(function addBook$(_context11) {\n              while (1) {\n                switch (_context11.prev = _context11.next) {\n                  case 0:\n                    _context11.prev = 0;\n                    _context11.next = 3;\n                    return call(function (bookData) {\n                      return axios.post('/book', bookData, {\n                        withCredentials: true\n                      });\n                    }, action.data);\n\n                  case 3:\n                    result = _context11.sent;\n                    _context11.next = 6;\n                    return put({\n                      type: ADD_BOOK_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context11.next = 13;\n                    break;\n\n                  case 8:\n                    _context11.prev = 8;\n                    _context11.t0 = _context11[\"catch\"](0);\n                    console.log(_context11.t0);\n                    _context11.next = 13;\n                    return put({\n                      type: ADD_BOOK_FAILURE,\n                      error: _context11.t0\n                    });\n\n                  case 13:\n                  case \"end\":\n                    return _context11.stop();\n                }\n              }\n            }, addBook, null, [[0, 8]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context12.stop();\n      }\n    }\n  }, _marked6);\n} // 장르 조회\n\n\nfunction watchLoadGenre() {\n  return _regeneratorRuntime.wrap(function watchLoadGenre$(_context14) {\n    while (1) {\n      switch (_context14.prev = _context14.next) {\n        case 0:\n          _context14.next = 2;\n          return takeLatest(LOAD_GENRE_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function loadGenre() {\n            var result;\n            return _regeneratorRuntime.wrap(function loadGenre$(_context13) {\n              while (1) {\n                switch (_context13.prev = _context13.next) {\n                  case 0:\n                    _context13.prev = 0;\n                    _context13.next = 3;\n                    return call(function () {\n                      return axios.get('/genres');\n                    });\n\n                  case 3:\n                    result = _context13.sent;\n                    _context13.next = 6;\n                    return put({\n                      type: LOAD_GENRE_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context13.next = 13;\n                    break;\n\n                  case 8:\n                    _context13.prev = 8;\n                    _context13.t0 = _context13[\"catch\"](0);\n                    console.log(_context13.t0);\n                    _context13.next = 13;\n                    return put({\n                      type: LOAD_GENRE_FAILURE,\n                      error: _context13.t0\n                    });\n\n                  case 13:\n                  case \"end\":\n                    return _context13.stop();\n                }\n              }\n            }, loadGenre, null, [[0, 8]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context14.stop();\n      }\n    }\n  }, _marked7);\n} // 작품 수정\n\n\nfunction watchUpdateBook() {\n  return _regeneratorRuntime.wrap(function watchUpdateBook$(_context16) {\n    while (1) {\n      switch (_context16.prev = _context16.next) {\n        case 0:\n          _context16.next = 2;\n          return takeLatest(UPDATE_BOOK_REQUEST,\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function updateBook(action) {\n            var result;\n            return _regeneratorRuntime.wrap(function updateBook$(_context15) {\n              while (1) {\n                switch (_context15.prev = _context15.next) {\n                  case 0:\n                    _context15.prev = 0;\n                    _context15.next = 3;\n                    return call(function (bookData) {\n                      return axios.patch(\"/book\", bookData, {\n                        withCredentials: true\n                      });\n                    }, action.data);\n\n                  case 3:\n                    result = _context15.sent;\n                    _context15.next = 6;\n                    return put({\n                      type: UPDATE_BOOK_SUCCESS,\n                      data: result.data\n                    });\n\n                  case 6:\n                    _context15.next = 13;\n                    break;\n\n                  case 8:\n                    _context15.prev = 8;\n                    _context15.t0 = _context15[\"catch\"](0);\n                    console.log(_context15.t0);\n                    _context15.next = 13;\n                    return put({\n                      type: UPDATE_BOOK_FAILURE,\n                      error: _context15.t0\n                    });\n\n                  case 13:\n                  case \"end\":\n                    return _context15.stop();\n                }\n              }\n            }, updateBook, null, [[0, 8]]);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context16.stop();\n      }\n    }\n  }, _marked8);\n}\n\nexport default function bookSaga() {\n  return _regeneratorRuntime.wrap(function bookSaga$(_context17) {\n    while (1) {\n      switch (_context17.prev = _context17.next) {\n        case 0:\n          _context17.next = 2;\n          return all([fork(watchLoadBooks), fork(watchLoadBook), fork(watchAddLikebook), fork(watchRemoveLikebook), fork(watchUploadImage), fork(watchAddBook), fork(watchLoadGenre), fork(watchUpdateBook)]);\n\n        case 2:\n        case \"end\":\n          return _context17.stop();\n      }\n    }\n  }, _marked9);\n}","map":{"version":3,"sources":["C:/Document/Backpot/front/sagas/book.js"],"names":["watchLoadBooks","watchLoadBook","watchAddLikebook","watchRemoveLikebook","watchUploadImage","watchAddBook","watchLoadGenre","watchUpdateBook","bookSaga","all","call","fork","throttle","takeLatest","put","axios","LOAD_BOOKS_REQUEST","LOAD_BOOKS_SUCCESS","LOAD_BOOKS_FAILURE","LOAD_BOOK_REQUEST","LOAD_BOOK_SUCCESS","LOAD_BOOK_FAILURE","ADD_LIKEBOOK_REQUEST","ADD_LIKEBOOK_SUCCESS","ADD_LIKEBOOK_FAILURE","REMOVE_LIKEBOOK_REQUEST","REMOVE_LIKEBOOK_SUCCESS","REMOVE_LIKEBOOK_FAILURE","UPLOAD_IMAGE_REQUEST","UPLOAD_IMAGE_SUCCESS","UPLOAD_IMAGE_FAILURE","ADD_BOOK_REQUEST","ADD_BOOK_FAILURE","ADD_BOOK_SUCCESS","LOAD_GENRE_REQUEST","LOAD_GENRE_SUCCESS","LOAD_GENRE_FAILURE","UPDATE_BOOK_REQUEST","UPDATE_BOOK_SUCCESS","UPDATE_BOOK_FAILURE","ADD_LIKEBOOKLIST","REMOVE_LIKEBOOKLIST","loadBooks","action","lastId","limit","get","result","type","data","console","log","error","loadBook","bookId","id","addLikebook","post","withCredentials","removeLikebook","uploadImage","formData","addBook","bookData","loadGenre","updateBook","patch"],"mappings":"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","sourcesContent":["import { all, call, fork, throttle, takeLatest, put } from 'redux-saga/effects';\r\nimport axios from 'axios';\r\nimport {\r\n  LOAD_BOOKS_REQUEST,\r\n  LOAD_BOOKS_SUCCESS,\r\n  LOAD_BOOKS_FAILURE,\r\n  LOAD_BOOK_REQUEST,\r\n  LOAD_BOOK_SUCCESS,\r\n  LOAD_BOOK_FAILURE,\r\n  ADD_LIKEBOOK_REQUEST,\r\n  ADD_LIKEBOOK_SUCCESS,\r\n  ADD_LIKEBOOK_FAILURE,\r\n  REMOVE_LIKEBOOK_REQUEST,\r\n  REMOVE_LIKEBOOK_SUCCESS,\r\n  REMOVE_LIKEBOOK_FAILURE,\r\n  UPLOAD_IMAGE_REQUEST,\r\n  UPLOAD_IMAGE_SUCCESS,\r\n  UPLOAD_IMAGE_FAILURE,\r\n  ADD_BOOK_REQUEST,\r\n  ADD_BOOK_FAILURE,\r\n  ADD_BOOK_SUCCESS,\r\n  LOAD_GENRE_REQUEST,\r\n  LOAD_GENRE_SUCCESS,\r\n  LOAD_GENRE_FAILURE,\r\n  UPDATE_BOOK_REQUEST,\r\n  UPDATE_BOOK_SUCCESS,\r\n  UPDATE_BOOK_FAILURE,\r\n} from '../reducers/book';\r\nimport { ADD_LIKEBOOKLIST, REMOVE_LIKEBOOKLIST } from '../reducers/user';\r\n\r\n// 전체 연재글 가져오기\r\nfunction* watchLoadBooks() {\r\n  yield throttle(1000, LOAD_BOOKS_REQUEST, function* loadBooks(action) {\r\n    try {\r\n      const result = yield call((lastId = 0, limit = 20) => {\r\n        return axios.get(`/books?lastId=${lastId}&limit=${limit}`);\r\n      }, action.lastId);\r\n      yield put({\r\n        type: LOAD_BOOKS_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: LOAD_BOOKS_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 게시글 하나 조회\r\nfunction* watchLoadBook() {\r\n  yield takeLatest(LOAD_BOOK_REQUEST, function* loadBook(action) {\r\n    try {\r\n      const result = yield call(bookId => {\r\n        return axios.get(`/book/${bookId}`);\r\n      }, action.id);\r\n      yield put({\r\n        type: LOAD_BOOK_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      put({\r\n        type: LOAD_BOOK_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 선호작 추가\r\nfunction* watchAddLikebook() {\r\n  yield takeLatest(ADD_LIKEBOOK_REQUEST, function* addLikebook(action) {\r\n    try {\r\n      const result = yield call(bookId => {\r\n        return axios.post(\r\n          `/book/${bookId}/like`,\r\n          {},\r\n          {\r\n            withCredentials: true,\r\n          },\r\n        );\r\n      }, action.bookId);\r\n      yield put({\r\n        type: ADD_LIKEBOOK_SUCCESS,\r\n        data: result.data,\r\n      });\r\n      yield put({\r\n        type: ADD_LIKEBOOKLIST,\r\n        data: {\r\n          id: result.data,\r\n          ...action.data,\r\n        },\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: ADD_LIKEBOOK_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 선호작 해제\r\nfunction* watchRemoveLikebook() {\r\n  yield takeLatest(REMOVE_LIKEBOOK_REQUEST, function* removeLikebook(action) {\r\n    try {\r\n      const result = yield call(bookId => {\r\n        return axios.delete(`/book/${bookId}/unlike`, {\r\n          withCredentials: true,\r\n        });\r\n      }, action.bookId);\r\n      yield put({\r\n        type: REMOVE_LIKEBOOK_SUCCESS,\r\n        data: result.data,\r\n      });\r\n      yield put({\r\n        type: REMOVE_LIKEBOOKLIST,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      put({\r\n        type: REMOVE_LIKEBOOK_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n// 썸네일 이미지 업로드\r\nfunction* watchUploadImage() {\r\n  yield takeLatest(UPLOAD_IMAGE_REQUEST, function* uploadImage(action) {\r\n    try {\r\n      const result = yield call(formData => {\r\n        return axios.post('/book/thumbnail', formData, {\r\n          withCredentials: true,\r\n        });\r\n      }, action.data);\r\n      yield put({\r\n        type: UPLOAD_IMAGE_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: UPLOAD_IMAGE_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 작품 만들기\r\nfunction* watchAddBook() {\r\n  yield takeLatest(ADD_BOOK_REQUEST, function* addBook(action) {\r\n    try {\r\n      const result = yield call(bookData => {\r\n        return axios.post('/book', bookData, {\r\n          withCredentials: true,\r\n        });\r\n      }, action.data);\r\n      yield put({\r\n        type: ADD_BOOK_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: ADD_BOOK_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 장르 조회\r\nfunction* watchLoadGenre() {\r\n  yield takeLatest(LOAD_GENRE_REQUEST, function* loadGenre() {\r\n    try {\r\n      const result = yield call(() => {\r\n        return axios.get('/genres');\r\n      });\r\n      yield put({\r\n        type: LOAD_GENRE_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: LOAD_GENRE_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 작품 수정\r\nfunction* watchUpdateBook() {\r\n  yield takeLatest(UPDATE_BOOK_REQUEST, function* updateBook(action) {\r\n    try {\r\n      const result = yield call(bookData => {\r\n        return axios.patch(`/book`, bookData, {\r\n          withCredentials: true,\r\n        });\r\n      }, action.data);\r\n      yield put({\r\n        type: UPDATE_BOOK_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: UPDATE_BOOK_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nexport default function* bookSaga() {\r\n  yield all([\r\n    fork(watchLoadBooks),\r\n    fork(watchLoadBook),\r\n    fork(watchAddLikebook),\r\n    fork(watchRemoveLikebook),\r\n    fork(watchUploadImage),\r\n    fork(watchAddBook),\r\n    fork(watchLoadGenre),\r\n    fork(watchUpdateBook),\r\n  ]);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}