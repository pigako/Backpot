{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.341141dd3edbd73dc401.hot-update.js","sources":["webpack:///./sagas/book.js"],"sourcesContent":["import { all, call, fork, throttle, takeLatest, put } from 'redux-saga/effects';\r\nimport axios from 'axios';\r\nimport {\r\n  LOAD_BOOKS_REQUEST,\r\n  LOAD_BOOKS_SUCCESS,\r\n  LOAD_BOOKS_FAILURE,\r\n  LOAD_BOOK_REQUEST,\r\n  LOAD_BOOK_SUCCESS,\r\n  LOAD_BOOK_FAILURE,\r\n  ADD_LIKEBOOK_REQUEST,\r\n  ADD_LIKEBOOK_SUCCESS,\r\n  ADD_LIKEBOOK_FAILURE,\r\n  REMOVE_LIKEBOOK_REQUEST,\r\n  REMOVE_LIKEBOOK_SUCCESS,\r\n  REMOVE_LIKEBOOK_FAILURE,\r\n} from '../reducers/book';\r\n\r\n// 전체 연재글 가져오기\r\nfunction* watchLoadBooks() {\r\n  yield throttle(1000, LOAD_BOOKS_REQUEST, function* loadBooks(action) {\r\n    try {\r\n      const result = yield call((lastId = 0, limit = 20) => {\r\n        return axios.get(`/books?lastId=${lastId}&limit=${limit}`);\r\n      }, action.lastId);\r\n      yield put({\r\n        type: LOAD_BOOKS_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: LOAD_BOOKS_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 게시글 하나 조회\r\nfunction* watchLoadBook() {\r\n  yield takeLatest(LOAD_BOOK_REQUEST, function* loadBook(action) {\r\n    try {\r\n      const result = yield call(bookId => {\r\n        return axios.get(`/book/${bookId}`);\r\n      }, action.id);\r\n      yield put({\r\n        type: LOAD_BOOK_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      put({\r\n        type: LOAD_BOOK_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 선호작 추가\r\nfunction* watchAddLikebook() {\r\n  yield takeLatest(ADD_LIKEBOOK_REQUEST, function* addLikebook(action) {\r\n    try {\r\n      const result = yield call(bookId => {\r\n        return axios.post(\r\n          `/book/${bookId}/like`,\r\n          {},\r\n          {\r\n            withCredentials: true,\r\n          },\r\n        );\r\n      }, action.bookId);\r\n      yield put({\r\n        type: ADD_LIKEBOOK_SUCCESS,\r\n        data: result.data,\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      yield put({\r\n        type: ADD_LIKEBOOK_FAILURE,\r\n        error: e,\r\n      });\r\n    }\r\n  });\r\n}\r\n// 선호작 해제\r\nfunction* watchRemoveLikebook() {}\r\nexport default function* bookSaga() {\r\n  yield all([\r\n    fork(watchLoadBooks),\r\n    fork(watchLoadBook),\r\n    fork(watchAddLikebook),\r\n    fork(watchRemoveLikebook),\r\n  ]);\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAkBA;;;AAoBA;;;AAoBA;;;AA0BA;;;AACA;AACA;AAtFA;AACA;AACA;AACA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AALA;AAEA;AAFA;AAKA;AACA;AACA;AAFA;AACA;AANA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAUA;AAVA;AAWA;AACA;AACA;AAFA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAkBA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AALA;AAEA;AAFA;AAKA;AACA;AACA;AAFA;AACA;AANA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAUA;AACA;AACA;AACA;AAFA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAkBA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAIA;AADA;AAIA;AACA;AAXA;AAEA;AAFA;AAWA;AACA;AACA;AAFA;AACA;AAZA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAgBA;AAhBA;AAiBA;AACA;AACA;AAFA;AACA;AAlBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAwBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;A","sourceRoot":""}