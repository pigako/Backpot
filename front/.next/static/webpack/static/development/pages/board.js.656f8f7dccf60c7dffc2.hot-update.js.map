{"version":3,"file":"static/webpack/static\\development\\pages\\board.js.656f8f7dccf60c7dffc2.hot-update.js","sources":["webpack:///./pages/board.js"],"sourcesContent":["import React, { useState, useRef, useCallback, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\nimport { useRouter } from 'next/router';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport Button from '../components/designs/Button';\r\nimport BoardTable from '../components/BoardTable';\r\nimport { LOAD_BOARDS_REQUEST, CHANGE_BOARD_KEYWORD } from '../reducers/board';\r\n\r\nconst SBoard = styled.div`\r\n  margin-top: 10px;\r\n`;\r\nconst BoardDivTop = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst SBoardTitle = styled.h1`\r\n  display: inline-block;\r\n  font-weight: bold;\r\n  margin-left: 10px;\r\n  width: 200px;\r\n`;\r\nconst SearchForm = styled.form`\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n  padding: 0px 10px;\r\n\r\n  width: 99%;\r\n\r\n  & a {\r\n    color: white;\r\n    height: 50px;\r\n    padding-right: 10px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n`;\r\n\r\nconst SearchInput = styled.input`\r\n  margin-right: 10px;\r\n  border: solid 2px #000000;\r\n  border-radius: 4px;\r\n  padding-left: 10px;\r\n\r\n  height: 2.25rem;\r\n  width: 10rem;\r\n  font-size: 1.5rem;\r\n\r\n  transition: 0.55s ease;\r\n\r\n  & :hover {\r\n    width: 30rem;\r\n  }\r\n  & :focus {\r\n    width: 30rem;\r\n  }\r\n`;\r\n\r\nconst PageButtonDiv = styled.div``;\r\n\r\nconst Board = () => {\r\n  const { boards, hasMoreBoards } = useSelector(state => state.board);\r\n  const { me } = useSelector(state => state.user);\r\n  const dispatch = useDispatch();\r\n  const router = useRouter();\r\n  const [lastIdArray, setLastIdArray] = useState([]);\r\n  const [keyword, setKeyword] = useState('');\r\n\r\n  const onScroll = useCallback(\r\n    e => {\r\n      if (\r\n        window.scrollY + document.documentElement.clientHeight >\r\n        document.documentElement.scrollHeight - 300\r\n      ) {\r\n        if (hasMoreBoards) {\r\n          let lastId = boards[boards.length - 1].id;\r\n          if (!lastIdArray.includes(lastId)) {\r\n            dispatch({\r\n              type: LOAD_BOARDS_REQUEST,\r\n              lastId,\r\n            });\r\n            setLastIdArray([...lastIdArray, lastId]);\r\n          }\r\n        }\r\n      }\r\n    },\r\n    [hasMoreBoards, boards.length],\r\n  );\r\n\r\n  useEffect(() => {\r\n    window.addEventListener('scroll', onScroll);\r\n    return () => {\r\n      window.removeEventListener('scroll', onScroll);\r\n      setLastIdArray([]);\r\n    };\r\n  }, [boards.length]);\r\n\r\n  const onCreateBoard = useCallback(e => {\r\n    router.push('/writeboard');\r\n  }, []);\r\n\r\n  const onChangeKeyword = useCallback(e => {\r\n    setKeyword(e.target.value);\r\n  }, []);\r\n\r\n  const onSearchBoard = useCallback(\r\n    e => {\r\n      e.preventDefault();\r\n      dispatch({\r\n        type: CHANGE_BOARD_KEYWORD,\r\n        data: keyword,\r\n      });\r\n      dispatch({\r\n        type: LOAD_BOARDS_REQUEST,\r\n        lastId: 0,\r\n        keyword,\r\n      });\r\n    },\r\n    [keyword],\r\n  );\r\n\r\n  return (\r\n    <SBoard>\r\n      <BoardDivTop>\r\n        <SBoardTitle>추천 게시판</SBoardTitle>\r\n        {me && <Button onClick={onCreateBoard}>글쓰기</Button>}\r\n        <SearchForm>\r\n          <SearchInput value={keyword} onChange={onChangeKeyword}></SearchInput>\r\n          <Button onClick={onSearchBoard}>검색</Button>\r\n        </SearchForm>\r\n      </BoardDivTop>\r\n      {boards && <BoardTable board={boards} />}\r\n      {boards && <PageButtonDiv></PageButtonDiv>}\r\n    </SBoard>\r\n  );\r\n};\r\n\r\nBoard.getInitialProps = async context => {\r\n  const state = context.store.getState();\r\n  context.store.dispatch({\r\n    type: LOAD_BOARDS_REQUEST,\r\n    lastId: 0,\r\n    keyword: state.board.keyword,\r\n  });\r\n};\r\n\r\nexport default Board;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAkBA;AAAA;AAAA;AAAA;AAoBA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AADA;AAAA;AACA;AADA;AAEA;AAAA;AAFA;AACA;AAEA;AACA;AACA;AALA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAOA;AAEA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAHA;AAKA;AAIA;AAIA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAQA;;;;A","sourceRoot":""}